generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  email     String   @unique
  name      String
  phone     String?
  password  String
  role      UserRole @default(ADMIN)
  avatar    String?
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  addresses Address[]
  cart      Cart?
  wishlist  Wishlist?


  @@map("users")
}

enum UserRole {
  ADMIN
}

model Address {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  userId      String   @db.ObjectId
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  fullName    String
  phone       String
  governorate String
  city        String
  district    String
  street      String
  buildingNo  String?
  floor       String?
  apartment   String?
  landmark    String?
  isDefault   Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  

  @@map("addresses")
}

model Product {
  id              String      @id @default(auto()) @map("_id") @db.ObjectId
  name            String?
  nameAr          String
  descriptionAr   String?
  categoryId      String      @db.ObjectId
  category        Category    @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  type            ProductType @default(RETAIL)
  price           Float
  originalPrice   Float?
  discount        Float       @default(0)
  wholesalePrice  Float?
  minWholesaleQty Int?
  weight          Float?
  unit            String
  origin          String?
  stock           Int         @default(0)
  isAvailable     Boolean     @default(true)
  isFeatured      Boolean     @default(false)
  isBestSeller    Boolean     @default(false)
  isNewArrival    Boolean     @default(false)
  mainImage       String
  images          String[]
  metaTitle       String?
  metaDescription String?
  metaKeywords    String[]
  views           Int         @default(0)
  salesCount      Int         @default(0)
  averageRating   Float       @default(0)
  totalReviews    Int         @default(0)
  createdAt       DateTime    @default(now())
  updatedAt       DateTime    @updatedAt

  reviews       Review[]
  orderItems    OrderItem[]
  cartItems     CartItem[]
  wishlistItems WishlistItem[]

  @@map("products")
}

enum ProductType {
  RETAIL
  WHOLESALE
  BOTH
}

model Category {
  id            String    @id @default(auto()) @map("_id") @db.ObjectId
  name          String    @unique
  nameAr        String?
  
  description   String?
  descriptionAr String?
  image         String?
  isActive      Boolean   @default(true)
  sortOrder     Int       @default(0)
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  products      Product[]

  @@map("categories")
}

model Review {
  id         String   @id @default(auto()) @map("_id") @db.ObjectId
  productId  String   @db.ObjectId
  product    Product  @relation(fields: [productId], references: [id], onDelete: Cascade)
  rating     Int
  comment    String?
  isApproved Boolean  @default(true)
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  @@map("reviews")
}

model Cart {
  id          String     @id @default(auto()) @map("_id") @db.ObjectId
  userId      String     @unique @db.ObjectId
  user        User       @relation(fields: [userId], references: [id], onDelete: Cascade)
  items       CartItem[]
  totalAmount Float      @default(0)
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt

  @@map("carts")
}

model CartItem {
  id            String   @id @default(auto()) @map("_id") @db.ObjectId
  cartId        String   @db.ObjectId
  cart          Cart     @relation(fields: [cartId], references: [id], onDelete: Cascade)
  productId     String   @db.ObjectId
  product       Product  @relation(fields: [productId], references: [id], onDelete: Cascade)
  quantity      Int      @default(1)
  price         Float
  originalPrice Float?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  @@map("cart_items")
}

model Wishlist {
  id        String         @id @default(auto()) @map("_id") @db.ObjectId
  userId    String         @unique @db.ObjectId
  user      User           @relation(fields: [userId], references: [id], onDelete: Cascade)
  items     WishlistItem[]
  createdAt DateTime       @default(now())
  updatedAt DateTime       @updatedAt

  @@map("wishlists")
}

model WishlistItem {
  id         String   @id @default(auto()) @map("_id") @db.ObjectId
  wishlistId String   @db.ObjectId
  wishlist   Wishlist @relation(fields: [wishlistId], references: [id], onDelete: Cascade)
  productId  String   @db.ObjectId
  product    Product  @relation(fields: [productId], references: [id], onDelete: Cascade)
  createdAt  DateTime @default(now())

  @@map("wishlist_items")
}
// schema.prisma

model Order {
  id            String      @id @default(auto()) @map("_id") @db.ObjectId
  orderNumber   String      @unique
  items         OrderItem[]
  
  // معلومات العميل والعنوان (مخزنة مباشرة في الطلب)
  customerName  String
  customerPhone String
  governorate   String
  city          String
  district      String
  street        String
  buildingNo    String?
  floor         String?
  apartment     String?
  landmark      String?
  
  // المبالغ المالية
  subtotal      Float
  discount      Float       @default(0)
  deliveryFee   Float       @default(0)
  tax           Float       @default(0)
  total         Float
  
  // حالات الطلب والدفع
  status        OrderStatus @default(PENDING)
  paymentStatus String
  paymentMethod String
  
  // معلومات التوصيل
  deliveryDate  DateTime?
  deliveryTime  String?
  
  // ملاحظات
  customerNotes String?
  adminNotes    String?
  
  // معلومات الإلغاء
  cancelReason  String?
  cancelledAt   DateTime?
  
  // التواريخ
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt
  
  @@map("orders")
}

model OrderItem {
  id           String   @id @default(auto()) @map("_id") @db.ObjectId
  orderId      String   @db.ObjectId
  order        Order    @relation(fields: [orderId], references: [id], onDelete: Cascade)
  productId    String   @db.ObjectId
  product      Product  @relation(fields: [productId], references: [id])
  productName  String
  productImage String
  quantity     Int
  price        Float
  total        Float
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  
  @@map("order_items")
}

enum OrderStatus {
  PENDING
  CONFIRMED
  PREPARING
  OUT_FOR_DELIVERY
  DELIVERED
  CANCELLED
  RETURNED
}

model AboutUsContent {
  id                 String   @id @default(auto()) @map("_id") @db.ObjectId
  heroTitle          String
  heroDescription    String
  heroImage          String
  visionTitle        String
  visionDescription  String
  visionImage        String
  missionTitle       String
  missionDescription String
  missionImage       String
  valuesTitle        String
  values             Value[]
  isActive           Boolean  @default(true)
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt

  @@map("about_us_contents")
}

type Value {
  title String
  image String
}

model ContactMessage {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  name      String
  email     String
  phone     String
  message   String
  isRead    Boolean  @default(false)
  isReplied Boolean  @default(false)
  notes     String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("contact_messages")
}

model ContactInfo {
  id              String      @id @default(auto()) @map("_id") @db.ObjectId
  heroTitle       String
  heroDescription String
  heroImage       String
  address         String
  email           String
  phone           String
  socialMedia     SocialMedia
  latitude        Float
  longitude       Float
  isActive        Boolean     @default(true)
  createdAt       DateTime    @default(now())
  updatedAt       DateTime    @updatedAt

  @@map("contact_info")
}

type SocialMedia {
  facebook  String?
  twitter   String?
  instagram String?
  youtube   String?
}

model HomepageContent {
  id                    String      @id @default(auto()) @map("_id") @db.ObjectId
  
  // Hero Section
  heroTitle             String?
  heroDescription       String?
  heroButtonText1      String?
  heroButtonText2      String?
  heroButtonLink1       String?
  heroButtonLink2       String?
  heroBackgroundImage1  String?
  heroBackgroundImage2  String?
  
  // Section Two
  sectionTwoTitle       String?
  sectionTwoDescription String?
  
  // Section Three
  sectionThreeTitle     String?
  
  // Section Four
  sectionFourTitle      String?
  sectionFourDescription String?
  sectionFourButtonText String?
  sectionFourButtonLink String?
  sectionFourImage      String?
  
  isActive              Boolean     @default(true)
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt

  @@map("homepage_content")
}